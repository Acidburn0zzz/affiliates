{% extends 'admin/base_site.html' %}

{% block extrastyle %}
<link rel="stylesheet" type="text/css" href="{{ MEDIA_URL }}css/jquery-ui/jquery-ui-1.8.18.custom.css" />
<link rel="stylesheet" type="text/css" href="{{ MEDIA_URL }}css/admin_stats.css" />
{% endblock %}

{% block extrahead %}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.min.js"></script>
<script src="{{ MEDIA_URL }}js/libs/jquery.flot.js"></script>
<script src="{{ MEDIA_URL }}js/admin_stats.js"></script>
{% endblock %}

{% block content_title %}{% endblock %}

{% block breadcrumbs %}
<div class="breadcrumbs">
  <a href="/admin">Home</a> &rsaquo; {{ title }}
</div>
{% endblock %}

{% block content %}
<div id="stats-container">
  <h1>{{ title }}</h1>

  <form class="stats-form" method="post">
    {% csrf_token %}
    <ul>
      {% for f in form %}
      <li>
        {{ f.label_tag }}
        {{ f }}
      </li>
      {% endfor %}
      <li>
        <button type="submit">Search!</button>
      </li>
    </ul>
  </form>

  {% if results %}
  <div id="graph" data-results="{{ results_json }}"></div>

  <table class="stats-table">
    <thead>
      <tr>
        <th>Date</th>
        <th>Value</th>
      </tr>
    </thead>
    <tbody>
      {% for date, value in results reversed %}
      <tr class="{% cycle 'row1' 'row2' %}">
        <td>{{ date }}</td>
        <td>{{ value }}</td>
      </tr>
      {% endfor %}
    </tbody>
    <tfoot>
      <tr>
        <td>Entire Period</td>
        <td>{{ aggregate }}</td>
      </tr>
    </tfoot>
  </table>
  {% else %}
  <p>There were errors with you input in the search form:</p>
  {{ form.errors }}
  {% endif %}
</div>
{% endblock %}
